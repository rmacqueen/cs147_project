
<!DOCTYPE html> 
<html>

<head>
	<title><%= @trip.name %></title> 
	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
 	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 

	<%= stylesheet_link_tag "jquery.mobile-1.2.0" %>
	<%= stylesheet_link_tag "style" %>
	<%= stylesheet_link_tag "trip_style" %>
	
	<%= javascript_include_tag "jquery-1.8.2.min.js" %>
    <%= javascript_include_tag "jquery.mobile-1.2.0.js" %>

</head> 
<body> 

<div data-role="page">

	<div data-role="header">
		<a href="/user/home/1" class="ui-btn-left">Back</a>
		<h1><%= @trip.name %></h1>


	</div><!-- /header -->

	<div data-role="content" id="page_test">
		<% i = 0 %>
<% for content in @all_content %>
	<% if content.content_type == "milestone" %>
		<h2 class="days"><%= content.value %> </h2>
		<% i = 0 %>
		<% next %> 
	<% end %>

	<% klass = "" %>
	<% index = i % 3 %>
	<% puts index %>
	<% case index %>
	<% when 0 %>
		<% klass = "cover" %>
	<% when 1 %>
		<div class="wrapper">
		<% klass = "side_left" %>
	<% when 2 %>
		<% klass = "side_right" %>

	<% end %>

	<% if content.content_type == "image" %>
		<%= render :partial => "image", :locals => {:content => content.value, :frame => klass, :width => content.width, :height => content.height} %>
	<% end %>


	<% if content.content_type == "text" %>

		<%= render :partial => "text", :locals => {:content => content.value, :frame => klass} %>

	<% end %>

	<% if index == 2 %>
		</div>
	<%end%>

	<% i+=1 %>
<% end %>

<script>
function getImageFile(){
	console.log("Getting an image")
   document.getElementById("upfile_image").click();
 }

function getVideoFile(){
	console.log("Getting a video")
   document.getElementById("upfile_video").click();
 }

 function sub(obj){
    var file = obj.value;
    var fileName = file.split("\\");
    console.log(file);
    //document.getElementById("yourBtn").innerHTML = fileName[fileName.length-1];
    document.myForm.submit();
    event.preventDefault();
  }
</script>
		
	</div><!-- /content -->


	

	<div data-role="footer" data-id="samebar" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
		<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
			<%= form_for :content, :html=>{:name=>"myForm", :multipart=>true, "data-ajax" => "false"}, :url => {:action => :post_add} do |form| %>

		<ul>

			<li><a href="#" id="home" data-icon="custom"  onclick="getImageFile()">Photo</a>
				<div style='height: 0px;width: 0px; overflow:hidden;'>

					<input type="number" name="trip_id" value=<%=@trip.id%>>

				</div>
				<div style='height: 0px;width: 0px; overflow:hidden;'>

					<%= form.file_field :photo, :accepts=>"image/*", :id=>"upfile_image", :onchange=>"sub(this)" %>

					<!--<input id="upfile_image" type="file" value="upload" accept="image/*" capture="camera" onchange="sub(this)"/>-->

				</div>
			</li>
			<li><a href="#" id="key" data-icon="custom" onclick="getVideoFile()">Video</a>
				<div style='height: 0px;width: 0px; overflow:hidden;'><input id="upfile_video" type="file" value="upload" accept="video/*" capture="camcorder" onchange="sub(this)"/></div>
			</li>
			<li><a href="#" id="beer" data-icon="custom" >Text</a></li>
			<li><a href="#" id="skull" data-icon="custom">More</a></li>

		</ul>
		<% end %>
		</div>
	</div>

</div><!-- /page -->

</body>
</html>